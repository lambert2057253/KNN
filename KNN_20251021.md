# ğŸŒ¸ K-Nearest Neighbors (KNN) æ•™å­¸æ–‡ä»¶  
## (ä»¥ Python ç‰©ä»¶å°å‘èˆ‡ scikit-learn å¯¦ä½œï¼ŒIRIS è³‡æ–™é›†ç‚ºä¾‹)

---

## ğŸ“˜ ä¸€ã€KNN æ¦‚å¿µèªªæ˜

**K-Nearest Neighbors (KNN)** æ˜¯ä¸€ç¨®åŸºæ–¼ã€Œè·é›¢ã€çš„ç›£ç£å¼å­¸ç¿’æ¼”ç®—æ³•ï¼Œå¸¸ç”¨æ–¼åˆ†é¡èˆ‡å›æ­¸å•é¡Œã€‚  
å…¶æ ¸å¿ƒæ€æƒ³ç‚ºï¼š
> ã€Œçµ¦å®šä¸€ç­†æœªçŸ¥é¡åˆ¥çš„è³‡æ–™ï¼Œæ‰¾å‡ºèˆ‡å®ƒæœ€æ¥è¿‘çš„ K å€‹å·²æ¨™è¨˜æ¨£æœ¬ï¼Œä¸¦æ ¹æ“šé€™äº›æ¨£æœ¬çš„é¡åˆ¥æŠ•ç¥¨æ±ºå®šçµæœã€‚ã€

---

## ğŸ§® äºŒã€KNN æ¼”ç®—æ³•æµç¨‹

1. é¸æ“‡é„°å±…æ•¸é‡ `K`
2. è¨ˆç®—æœªçŸ¥æ¨£æœ¬èˆ‡æ‰€æœ‰æ¨£æœ¬çš„è·é›¢ï¼ˆå¸¸ç”¨æ­æ°è·é›¢ï¼‰
3. é¸æ“‡è·é›¢æœ€è¿‘çš„ `K` ç­†è³‡æ–™
4. æ ¹æ“šå¤šæ•¸æŠ•ç¥¨æ±ºå®šåˆ†é¡ï¼ˆæˆ–å¹³å‡æ•¸æ±ºå®šå›æ­¸ï¼‰
5. è¼¸å‡ºé æ¸¬çµæœ

---

## ğŸ“Š ä¸‰ã€IRIS è³‡æ–™é›†ç°¡ä»‹

Iris dataset ç‚º scikit-learn å…§å»ºçš„ç¶“å…¸è³‡æ–™é›†ï¼ŒåŒ…å« 150 ç­†è³‡æ–™ã€4 å€‹ç‰¹å¾µèˆ‡ 3 ç¨®èŠ±é¡åˆ¥ï¼š

| ç‰¹å¾µåç¨± | èªªæ˜ |
|-----------|------|
| sepal length (cm) | èŠ±è¼é•·åº¦ |
| sepal width (cm)  | èŠ±è¼å¯¬åº¦ |
| petal length (cm) | èŠ±ç“£é•·åº¦ |
| petal width (cm)  | èŠ±ç“£å¯¬åº¦ |

é¡åˆ¥åŒ…å«ï¼š
- **Setosa**
- **Versicolor**
- **Virginica**

---

## âš™ï¸ å››ã€Python ç‰©ä»¶å°å‘å¯¦ä½œ (OOP Implementation)

```python
from sklearn.datasets import load_iris
import numpy as np
from collections import Counter

class KNNClassifier:
    """è‡ªè¨‚ KNN åˆ†é¡å™¨ (ç‰©ä»¶å°å‘ç‰ˆæœ¬)"""
    def __init__(self, k=3):
        self.k = k

    def fit(self, X_train, y_train):
        """å„²å­˜è¨“ç·´è³‡æ–™"""
        self.X_train = X_train
        self.y_train = y_train

    def predict(self, X_test):
        """å°æ¸¬è©¦è³‡æ–™é€²è¡Œé æ¸¬"""
        predictions = [self._predict_one(x) for x in X_test]
        return np.array(predictions)

    def _predict_one(self, x):
        """è¨ˆç®—å–®ä¸€æ¨£æœ¬çš„æœ€è¿‘é„°"""
        distances = np.linalg.norm(self.X_train - x, axis=1)
        k_indices = np.argsort(distances)[:self.k]
        k_neighbor_labels = self.y_train[k_indices]
        most_common = Counter(k_neighbor_labels).most_common(1)
        return most_common[0][0]

# è¼‰å…¥ IRIS è³‡æ–™é›†
iris = load_iris()
X, y = iris.data, iris.target

# åˆ‡å‰²è¨“ç·´/æ¸¬è©¦é›†
from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# å»ºç«‹æ¨¡å‹ä¸¦é æ¸¬
model = KNNClassifier(k=5)
model.fit(X_train, y_train)
predictions = model.predict(X_test)

# æº–ç¢ºç‡
accuracy = np.mean(predictions == y_test)
print(f"KNN è‡ªè¨‚æ¨¡å‹æº–ç¢ºç‡: {accuracy:.2f}")
```

## äº”ã€ä½¿ç”¨ scikit-learn å…§å»º KNN æ¨¡å‹
```python
from sklearn.neighbors import KNeighborsClassifier
from sklearn.metrics import accuracy_score

# å»ºç«‹æ¨¡å‹
knn = KNeighborsClassifier(n_neighbors=5)
knn.fit(X_train, y_train)

# é æ¸¬
y_pred = knn.predict(X_test)

# è©•ä¼°
acc = accuracy_score(y_test, y_pred)
print(f"scikit-learn KNN æº–ç¢ºç‡: {acc:.2f}")
```
## å…«ã€å¯è¦–åŒ– (æ±ºç­–é‚Šç•Œç¯„ä¾‹)
```python
import matplotlib.pyplot as plt
from matplotlib.colors import ListedColormap

X_vis = X[:, :2]  # åªå–å‰å…©å€‹ç‰¹å¾µ
knn_vis = KNeighborsClassifier(n_neighbors=5)
knn_vis.fit(X_vis, y)

# å»ºç«‹ç¶²æ ¼
x_min, x_max = X_vis[:, 0].min() - 1, X_vis[:, 0].max() + 1
y_min, y_max = X_vis[:, 1].min() - 1, X_vis[:, 1].max() + 1
xx, yy = np.meshgrid(np.arange(x_min, x_max, 0.02),
                     np.arange(y_min, y_max, 0.02))

Z = knn_vis.predict(np.c_[xx.ravel(), yy.ravel()])
Z = Z.reshape(xx.shape)

cmap_light = ListedColormap(['#FFAAAA', '#AAFFAA', '#AAAAFF'])
cmap_bold = ListedColormap(['#FF0000', '#00FF00', '#0000FF'])

plt.figure(figsize=(8,6))
plt.pcolormesh(xx, yy, Z, cmap=cmap_light)
plt.scatter(X_vis[:, 0], X_vis[:, 1], c=y, cmap=cmap_bold, edgecolor='k', s=30)
plt.title("KNN æ±ºç­–é‚Šç•Œ (K=5)")
plt.xlabel("Sepal length (cm)")
plt.ylabel("Sepal width (cm)")
plt.show()

```
